---
title: "Моя идеология работы с TypeScript"
date: "2016-08-04T11:51:32.00Z"
description: "Надо писать на JS с типами, а не превращать код в C# Зачем нужна типизация в JavaScript? Без нее JavaScript хорошо жил на протяж"
---

<h4>Надо писать на JS с типами, а не превращать код в C#</h4>
<h4>Зачем нужна типизация в JavaScript?</h4>
<p>Без нее JavaScript хорошо жил на протяжении более 20 лет. Но <strong>раньше на JS не решались</strong> сложные задачи мега уровня (энтепрайз, банки и все такое…). Сейчас этот язык вышел за пределы браузера и зашел на территорию бэкенда, десктопных приложений, расширений для браузеров и мобильные устройства, интернет вещей (IoT), к примеру микроконтроллеры <a href="https://tessel.io/" target="_blank" rel="noopener noreferrer">https://tessel.io</a>.</p>
<p>При написании большого приложения становится сложно отлавливать ошибки, которые часто связаны именно с приведением типов.</p>
<h4>TypeScript</h4>
<p>Да — это помощь. Хотите чтобы JavaScript превратился из языка с динамической неявной типизацией в язык со <strong>строгой явной динамической тпизацией</strong>? Тогда выбирайте TypeScript. Да, он делает разработку сложнее, если вы не работали никогда с явными строгими типами.</p>
<h4>Так после компиляции типов не будет же…</h4>
<p>Открою секрет, но в языках типа Java типы проверяются компилятором на этапе компиляции, а в runtime нет никаких проверок. И если у вас придет неверный тип — программа выкинет исключение (если вообще не упадет (ну вы же готовы к этому и обработали исключение ☺)).</p>
<h4>Моя идеология работы с TypeScript</h4>
<p>TypeScript — это JavaScript с опциональной типизацией. Не надо превращать ваш код в C#. Все должно быть в разумных пределах. Если вам нужно разработать продукт быстро и вчера, то вы пишете на TypeScript как на обычном ES6+, и используете примитивы или несложные интерфейсы. Когда ваш MVP взлетел и вы поняли что готовы развивать его, вы выделяете время на рефакторинг и уже описываете типы серьезно.</p>
<p>Описывать типы важно для вашего кода! Все что в <em>node_modules </em>мы считаем черной коробочкой. Если хочется крутой типизации и крутых подскзок в IDE, ставим декларации (d.ts файлы) через утилиту <a href="https://www.npmjs.com/package/typings" target="_blank" rel="noopener noreferrer">typings</a>.</p>
<p>Если у вас проблемы при работе с типами от сторонних библиотек (React.d.ts, Moment.d.ts, …) то есть два пути:</p>
<ol>
<li>Залезть в файл и исправить ошибку в декларации (да да, все эти декларации пишут люди, порой вообще никак не связанные с проектом)</li>
<li>Написать свои декларации заглушки</li>
</ol>
<pre>declare module "React";</pre>
<p>И уже по мере работы, находя свободное время, расширять декларацию-заглушку до нормального состояния. Таким образом вы даже освобождаете себя от “вендор-лока”. Что будет если выйдет новая версия React? Кто будет править (и главное, когда) d.ts файлы?</p>
<h4>За use’ал библиотеку, а там нет d.ts файлов ☹</h4>
<p>Да, такое бывает. Например я решил использовать Redux-Elm. Как быть?</p>
<p>Ищите файлы с расширением <strong>.flow</strong>. Если вдруг нашли, вам повезло. Хоть синтаксис Flowtype отличается от TypeScript, все же вам будет проще переписать это на TS. Так я и поступил.</p>
<p><a href="https://gist.github.com/frontdevops/868670e35cadad15dedb8fce3143d8ce">https://gist.github.com/frontdevops/868670e35cadad15dedb8fce3143d8ce</a></p>
<p>А так выглядит переписанная за 5 минут декларация на TypeScript:</p>
<p><a href="https://gist.github.com/frontdevops/1bd8503c34412d8dc9999cb2bb8e399c">https://gist.github.com/frontdevops/1bd8503c34412d8dc9999cb2bb8e399c</a></p>
<p>Исходники можно взять с Github <a href="https://github.com/frontdevops/redux-elm-typescript" target="_blank" rel="noopener noreferrer">https://github.com/frontdevops/redux-elm-typescript</a></p>
<p>Если же нет вообще никаких деклараций, то возвращаемся к способу: описать заглушку вида:</p>
<pre>declare module "redux-elm";</pre>
<p>И уже постепенно описывать по 1й функции, которые используете.</p>
<h4>Хочу проверку типов в runtime</h4>
<p>Тогда нужно что-то вроде RTTS (RunTime Type System). Я сделал такой пакет ради академического интереса (но не финализировал его). Этот NPM пакет добавляет в проект аннотации типов через декораторы и делает проверку прямо в runtime. Если у кого-то есть интерес к RTTS, предлагаю присоединиться и реально его довести до финала.</p>

<h3>Давайте общаться</h3>
<p>Я всегда открыт к критике и дискуссиям. В общении рождается истина, как мне кажется. Хотите что-то добавить или поправить — пишите. Я буду очень рад вашим комментариям.</p>
<p>А еще я предлагаю посмотреть мой доклад про TypeScript: “Фишки и прелести TypeScript”</p>
<p>И так же в продолжении темы идеологически похожий доклад от <a href="https://medium.com/u/5e36396bb2b8" target="_blank" rel="noopener noreferrer">Grigory Petrov</a> про типизацию в Python: “Type: Python vs TypeScript”</p>
<p><iframe title="Григорий Петров: &quot;Типы: Python vs Typescript&quot;" width="580" height="326" src="https://www.youtube.com/embed/fxpgLz6W7eY?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></p>


