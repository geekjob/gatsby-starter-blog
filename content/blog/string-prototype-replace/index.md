---
title: "String.prototype.replace"
date: "2019-09-08T18:23:52.00Z"
description: "Регулярки, колбэки и… Шаблоны! Сегодня короткий пост про простую функцию replace в мире JS. Чтобы понять нужно ли вами читать эт"
---

<!--kg-card-begin: html--><h4>Регулярки, колбэки и… Шаблоны!</h4>
<p>Сегодня короткий пост про простую функцию replace в мире JS. Чтобы понять нужно ли вами читать этот пост пройдите микро тест:</p>
<pre>'abc'.replace('a', '$$$') // = ???</pre>
<p>Смогли ответить и понимаете почему так? Значит вам не стоит читать текст далее. Для остальных — велком…</p>
<p>Функция <code>replace</code> вроде бы простая функция, ничего сложного. Правда при переходе из других языков с толку могут сбить разные нюансы использования этого метода (в JS это метод объекта String, а не функция). Хороший вопрос — на что можно заменять? Что можно подставить вторым параметром?</p>
<p>Многие, кто работает с JS знает, что replace вторым аргументом может принимать строки, колбэк-функции для замены и строки с плейсхолдерами, если было использовано регулярное выражение.</p>
<p>Плейсхолдеры регулярок похожи на то, что есть и в других языках. Но начинаются они с символа $. Например:</p>
<pre>'start abc foo stop'.replace(/(start)(.*)(stop)/, '[$1]{ $2 }[$3]')<br>// [start]{  abc foo  }[stop]</pre>
<p>Таким образом мы можем легко манипулировать найденными блоками.</p>
<p>И все бы ничего, но в JS помимо всего прочего в методе replace есть еще поддержка шаблонов. И вот про шаблоны многие либо не знают, либо забывают. Шаблоны начинаются с символа $ и могут быть:</p>
<ul>
<li>
<code>$$</code> — вставляет символ доллара «$»</li>
<li>
<code>$&amp;</code> — вставляет сопоставившуюся подстроку</li>
<li>
<code>$`</code> — вставляет часть строки, предшествующую сопоставившейся подстроке.</li>
<li>
<code>$’</code> — вставляет часть строки, следующую за сопоставившейся подстрокой</li>
</ul>
<p>И эти шаблоны могут работать как с регулярными выражениями, так и без:</p>
<pre>'foo'.replace('foo', '$&amp;-$&amp;-$&amp;') // "foo-foo-foo"<br>'foo'.replace(/fo{2}/, '$&amp;-$&amp;-$&amp;') // "foo-foo-foo"</pre>
<p>С помощью регулярок можно решить почти любую задачу, но иногда достаточно использовать встроенные шаблоны. Кстати, с помощью этих шаблонов можно решить часть задач, которые с помощью регулярок делаются более многословно, плюс ко всему требуют RegEx объект, в то время как шаблоны работают вне зависимости от входного параметра.</p>
<pre>'This is a test text'.replace('test', '$`')<br>// result: "This is a This is a  text"</pre>
<pre>// Этот шаблон эквивалентен регулярке:<br>'This is a test text'.replace(/(.*)test(.*)/, '$1$1$2')</pre>
<p>Другой пример:</p>
<pre>'This is a test text'.replace('test', "$'")<br>// result: "This is a  text text"</pre>
<pre>// Этот шаблон эквивалентен регулярке:<br>'This is a test text'.replace(/(.*)test(.*)/, "$1$2$2")</pre>
<p>Хотя регулярные выражения более гибкие, все же стоит знать про такие особенности, чтобы потом не удивляться почему при замене на <code>$$</code> получается один символ <code>$</code> вместо двух.</p>
<p>И все это есть в <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter" target="_blank" rel="noopener noreferrer">документации</a>, но кто ее читает, да?</p>

<!--kg-card-end: html-->

