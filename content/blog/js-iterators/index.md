---
title: "Используем итераторы в JS"
date: "2018-03-06T22:03:16.00Z"
description: "Меняем подход к циклам Вопрос на собеседовании — назовите все способы пройтись по всем элементам массива/объекта. Полный ответ в"
---

<!--kg-card-begin: html--><h4>Меняем подход к циклам</h4>
<p>Вопрос на собеседовании — назовите все способы пройтись по всем элементам массива/объекта. Полный ответ включает в себя список:</p>
<ul>
<li>циклы for, while, do while</li>
<li>for-in и for-of</li>
<li>методы map, foreach, filter, reduce, reduceRight, every, some</li>
<li>итераторы</li>
</ul>
<h3>Итераторы</h3>
<p>Вот про итераторы часто забывают. В работе могут быть случаи, когда работать с итераторами будет комфортнее и удобнее, чем с классическим подходом. Я покажу на простом примере скрипта с разбором строки аргументов. Допустим, мы пишем CLI версию какой-то утилиты под Node.js</p>
<p>Наша утилита будет вызываться как-то так:</p>
<pre>node mytool.js some arguments data</pre>
<p>Как получить аргументы? Верно, использовать встроенное поле argv в объекте process:</p>
<pre>console.log(process.argv)</pre>
<p>Если запустим наш пример, получим:</p>
<pre>node iterator.js some arguments data<br>[ '/usr/local/bin/node',<br>  '/Users/mayorov/workspace/vacancy.new.hr/iterator.js',<br>  'some',<br>  'arguments',<br>  'data' ]</pre>
<p>Вы хотите обрабатывать эти аргументы. Что советуют гугл и документация? Если не вдаваться в подробности как заиспользовать какой-то очередной NPM пакет(а вы знаете, наверное, что я очень не люблю использовать чужие пакеты, которые написаны в пару строк кода и решают простые вещи. Я такие компоненты называю leftpad-like или лефтаподободобные). Для того, чтобы получить нужные данные и отсечь первые 2 элемента мы можем поступить так:</p>
<pre><code><strong>process</strong>.argv.<strong>forEach</strong>((val, index, arr) =&gt; {<br> // что-то делаем и сохраняем наши данные куда-то<br>});</code></pre>
<p>Примитивный и первое что приходит в голову. Сюда же можно отнести все способы с map и reduce. Можем изменить сам массив argv:</p>
<pre><strong>process</strong>.argv.<strong>shift</strong>();<br><strong>process</strong>.argv.<strong>shift</strong>();</pre>
<pre>// process.argv - теперь содержит только наши аргументы без "лишних" системных</pre>
<p>Но это же не тру, нарушает иммутабельность и может повлечь к непредсказуемым результатам (вдруг в какой-то версии ноды это поле сделают readonly).</p>
<p>Можем создать клон массива аргументов с фильтрацией:</p>
<pre><strong>const</strong> argv = <strong>process</strong>.argv.<strong>filter</strong>((<em>x</em>, <em>i</em>) =&gt; i &gt; 1);<br><strong>console</strong>.log(argv);</pre>
<pre><em>// [ 'some', 'arguments', 'data' ]</em></pre>
<p>Нууу. Работает, иммутабельно и даже можно сказать, что решение-то ок. Но минус подхода — это копия с данными. Зачем копировать?</p>
<p>Я покажу еще один способ с применением итератора:</p>
<pre><strong>const</strong> argv = <strong>process</strong>.argv[<strong>Symbol</strong>.iterator]();</pre>
<pre><strong>const</strong> bin = argv.next().value;<br><strong>const</strong> file = argv.next().value;</pre>
<pre><em>// У нас сохранилась позиция на 2м элементе и цикл for-of продолжит итерироваться с 2 индекса</em></pre>
<pre><strong>for</strong> (<strong>let</strong> item <strong>of</strong> argv) {<br><strong>console</strong>.log(item);<br>    // Что-то тут делаем, что нам нужно<br>}</pre>
<pre>// Output:<br>some<br>arguments<br>data</pre>
<p>При этом мы не делаем копию с данными, у нас применяется принцип иммутабельности и мы не нарушаем исходный массив аргументов.</p>
<p>Если же говорить про реальные продакшн скрипты, чаще можно увидеть такой вариант:</p>
<pre><strong>const</strong> [bin, file, …argv] = process.argv;</pre>
<p>Данный пример выглядит проще, но мы создаем копию массива с аргументами. На данном примере с разбором аргументов преимущества применения итератора не очевидны, но и задача была показать как это можно применять. Больше знаний — больше возможностей.</p>
<p>Что лучше — решать вам, но лучше знать про все способы, чтобы всегда был выбор ?</p>
<hr>
<p>Кстати, следить за обновлениями и прочими материалами от меня можно в телеграм канале: <a href="https://web.telegram.org/#/im?p=@prowebit" target="_blank" rel="noopener noreferrer">@prowebit</a></p>
<p>В этом канале публикую не только статьи из этого блога, но и различные новости и мысли. Подписывайтесь ?</p>
<!--kg-card-end: html-->

