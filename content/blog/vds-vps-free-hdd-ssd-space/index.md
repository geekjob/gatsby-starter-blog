---
title: "Узнаем кто украл место на диске"
date: "2018-03-21T17:33:06.000Z"
description: "Bash зарисовки
У вас есть сервер и вот однажды наступает момент, когда дисковое пространство
заканчивается. Это может быть все ч"
---

<h4>Bash зарисовки</h4>
<p>У вас есть сервер и вот однажды наступает момент, когда дисковое пространство заканчивается. Это может быть все что угодно, от неверно настроенного сбора логов, до различных кешей от докеров и прочих приложений. Как узнать кто самый пухлый, кто занимает пространство? Есть в Linux’ах 2 полезные утилиты: df и du.</p>
<p>Одна показывает свободное место, другая как используется диск (какой файл сколько занимает). Вы смотрите с помощью df сколько у вас есть места:</p>
<pre>df -h</pre>
<p>и понимаете, что осталось свободно пара гигабайт. Кто скушал пространство?</p>
<h4>Смотрим самые большие файлы и директории в Linux</h4>
<p>Если нужно найти самые большие директории и файлы в конкретном каталоге, то используем команду:</p>
<pre>du -a /your/directory | sort -nr | head -n 30</pre>
<p>Выведет отсортированный список в порядке убывания. Вывод будет выглядеть так:</p>
<pre>14778156 /<br>5117688 /usr<br>3549640 /root<br>3178464 /www<br>1422364 /usr/lib<br>...</pre>
<h4>Вывести данные в удобочитаемом виде</h4>
<pre>du -hs * | sort -rh | head -20</pre>
<p>Выдаст:</p>
<pre>4.9G    usr<br>1.1G    var<br>893M    home<br>127M    run<br>48M     etc<br>1.1M    tmp<br>24K     share<br>4.0K    mnt</pre>
<h4>Вывести данные, включая субдиректории</h4>
<pre>du -Sh | sort -rh | head -20</pre>
<h4>Найти только самые большие файлы</h4>
<pre>find / -type f -exec du -Sh {} + | sort -rh | head -n 20<br># или<br>find / -type f -printf "%s %pn" | sort -rn | head -n 20</pre>
<h3>Еще статьи по теме</h3>
<p><a href="https://medium.com/@frontman/%D1%87%D0%B8%D1%81%D1%82%D0%B8%D0%BC-%D0%BC%D0%B5%D1%81%D1%82%D0%BE-%D0%BD%D0%B0-vps-vds-%D1%81-%D0%B4%D0%BE%D0%BA%D0%B5%D1%80%D0%B0%D0%BC%D0%B8-863f0ccf2ef1">https://medium.com/@frontman/%D1%87%D0%B8%D1%81%D1%82%D0%B8%D0%BC-%D0%BC%D0%B5%D1%81%D1%82%D0%BE-%D0%BD%D0%B0-vps-vds-%D1%81-%D0%B4%D0%BE%D0%BA%D0%B5%D1%80%D0%B0%D0%BC%D0%B8-863f0ccf2ef1</a></p>


